<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBSFUXIA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Grid background -->
    <div class="grid-background"></div>

    <div class="app-container">
        <div class="header">
            <h1>OBSFUXIA</h1>
            <div class="meta">
                <div id="username">WIP by @snaykey</div>
                <!-- Removed datetime display as it wasn't updated by JS -->
                <!-- <div id="datetime">Loading...</div> -->
            </div>
        </div>

        <div class="methods-panel">
            <div class="category collapsed" id="encoding-category"> <!-- Start collapsed -->
                <div class="category-header">
                    <span>▶ Encoding</span>
                </div>
                <div class="category-methods">
                    <div class="method-box" data-method="Base64">
                        Base64
                        <span class="info-icon" title="Encodes text to Base64, a binary-to-text encoding that represents binary data in ASCII format. Often used for email attachments and basic data obfuscation.">?</span>
                    </div>
                    <div class="method-box" data-method="Hexadecimal">
                        Hex
                        <span class="info-icon" title="Converts each character to its hexadecimal (base 16) ASCII value. Each character becomes a 2-digit hex code.">?</span>
                    </div>
                    <div class="method-box" data-method="Binary">
                        Binary
                        <span class="info-icon" title="Converts each character to its binary (base 2) representation. Each character becomes an 8-bit sequence of 0s and 1s.">?</span>
                    </div>
                </div>
            </div>

            <div class="category collapsed" id="cipher-category"> <!-- Start collapsed -->
                <div class="category-header">
                    <span>▶ Substitution</span>
                </div>
                <div class="category-methods">
                    <div class="method-box" data-method="ROT13">
                        ROT13
                        <span class="info-icon" title="Rotates each letter 13 positions in the alphabet. Self-reciprocal cipher (applying it twice returns the original text). Only affects A-Z.">?</span>
                    </div>
                    <div class="method-box" data-method="Caesar" data-customizable="true">
                        Caesar
                        <span class="info-icon" title="Shifts each letter (A-Z) by a fixed number of positions (1-25) in the alphabet. Named after Julius Caesar who used it with a shift of 3.">?</span>
                    </div>
                    <div class="method-box" data-method="Vigenere" data-customizable="true">
                        Vigenère
                        <span class="info-icon" title="Uses a keyword (letters A-Z only) to determine variable shift values for each letter. More secure than Caesar cipher. Case is preserved.">?</span>
                    </div>
                    <div class="method-box" data-method="Atbash">
                        Atbash
                        <span class="info-icon" title="Substitutes each letter with its reverse position in the alphabet (A→Z, B→Y, etc). Ancient cipher. Case is preserved.">?</span>
                    </div>
                </div>
            </div>

            <div class="category collapsed" id="transform-category"> <!-- Start collapsed -->
                <div class="category-header">
                    <span>▶ Transform</span>
                </div>
                <div class="category-methods">
                    <div class="method-box" data-method="Reverse">
                        Reverse
                        <span class="info-icon" title="Simply reverses the order of characters in the text. First character becomes last, and so on. Handles Unicode correctly.">?</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="main-panel">
            <div class="chain-section">
                <!-- Chain display area (filled by JS) -->
                <div class="chain-display" id="chainDisplay">
                    <!-- Content generated by JS -->
                </div>
                <!-- Controls moved OUTSIDE the display area -->
                <div class="chain-controls">
                    <button type="button" id="reverseChainButton" title="Reverse the order of steps in the chain">REVERSE</button>
                    <button type="button" id="clearChainButton" title="Remove all steps from the chain">CLEAR</button>
                </div>
            </div>

            <div class="input-output-section">
                <div class="text-container">
                    <textarea id="text" placeholder="Enter text to process..."></textarea>
                </div>

                <div class="controls-row"> <!-- Group controls for better layout -->
                    <div class="process-mode" title="Order to apply methods during Obfuscation">
                         <span>Process Order:</span>
                        <button type="button" id="sequentialMode">Sequential</button>
                        <button type="button" id="reverseMode">Reverse</button>
                    </div>

                    <div class="direction-toggle">
                        <button type="button" id="obfuscateButton">Obfuscate ↓</button>
                        <button type="button" id="deobfuscateButton">Deobfuscate ↑</button>
                    </div>
                 </div>

                <div class="result-container">
                    <div class="result-header">
                        <span>Output:</span>
                    </div>
                    <div id="result"></div> <!-- Output appears here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="modalOverlay"></div>

    <div id="caesarModal" class="method-modal">
        <h3>Caesar Cipher Shift</h3>
        <label for="caesarShift">Shift amount (1-25):</label>
        <input type="number" id="caesarShift" value="3" min="1" max="25" placeholder="Enter shift">
        <div class="method-modal-buttons">
            <button type="button" id="caesarConfirm">Confirm</button>
            <button type="button" class="modal-cancel">Cancel</button>
        </div>
    </div>

    <div id="vigenereModal" class="method-modal">
        <h3>Vigenère Cipher Key</h3>
         <label for="vigenereKey">Keyword (A-Z only):</label>
        <input type="text" id="vigenereKey" placeholder="Enter keyword" pattern="[a-zA-Z]+" title="Only letters A-Z are used for the key">
        <div class="method-modal-buttons">
            <button type="button" id="vigenereConfirm">Confirm</button>
            <button type="button" class="modal-cancel">Cancel</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>